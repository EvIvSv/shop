<?phpinclude_once('Controller/C_Base.php');//// Конттроллер страницы Регистрации нового пользователя.//class C_Reg extends C_Base{	private $error;	// ошибка	private $name;	private $fam;	private $login;	private $relogin;	private $phone;		//	// Конструктор.	//	function __construct()	{		        $this->error = null;	}		//	// Виртуальный обработчик запроса.	//	protected function OnInput()	{		parent::OnInput();		$this->title = 'Регистрация';		if (isset($_POST['reg']))		{			// чтение данных из формы и их подготовка			$name = trim($_POST['name']);			$fam = trim($_POST['fam']);			$login = trim($_POST['login']);			$relogin = trim($_POST['relogin']);			$pass = trim($_POST['pass']);			$repass = trim($_POST['repass']);			$phone = trim($_POST['phone']);						// заполнение полей класса			$this->name = $name;			$this->fam = $fam;			$this->login = $login;			$this->relogin = $relogin;			$this->phone = $phone;			if (M_Users::Instance()->GetByLogin($login) == true)			{				// если пользователь с таким именем уже существует				$this->error = 'Пользователь с таким именем уже существует';			}				else if ($name == '' or $fam == '' or $login == '' or $pass == '')				{					// если заполнены не все поля формы					$this->error = 'Заполнены не все обязательные поля';				}					else if ($login !== $relogin)					{						// Логины не совпадают						$this->error = 'Логины не совпадают';					}						else if ($pass !== $repass)						{							// пароли не совпадают							$this->error = 'Пароли не совпадают';						}			else						{				// удачная отправка формы				M_Users::Instance()->Add($name, $fam, $login, $pass, $phone);				header('Location: index.php');				die();			}		}	}		//	// Виртуальный генератор HTML.	//		protected function OnOutput()	{		$vars = array('error' => $this->error, 'name' => $this->name, 'fam' => $this->fam, 'login' => $this->login, 'relogin' => $this->relogin, 'phone' => $this->phone);			$this->content = $this->Template('View/V_Reg.php', $vars);		parent::OnOutput();	}	}